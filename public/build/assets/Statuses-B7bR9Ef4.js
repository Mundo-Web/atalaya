var w=Object.defineProperty;var R=(n,t,a)=>t in n?w(n,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[t]=a;var m=(n,t,a)=>(R(n,typeof t!="symbol"?t+"":t,a),a);import{m as i,C as v,c as x,R as s,r as d}from"./CreateReactScript-CMiyu2aM.js";import{A as T}from"./Adminto-BPeyNqsd.js";import{T as C,R as l,a as p,M as F,I as S}from"./InputFormGroup-BMI1v1th.js";import{T as O}from"./TextareaFormGroup-CkLVDc6p.js";class u{}m(u,"paginate",async t=>{const{result:a}=await i.Fetch("/api/statuses/paginate",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)});return a}),m(u,"save",async t=>{try{const{status:a,result:r}=await i.Fetch("/api/statuses",{method:"POST",body:JSON.stringify(t)});if(!a)throw new Error((r==null?void 0:r.message)||"Ocurrio un error inesperado");return i.Notify.add({icon:"/assets/img/logo.svg",title:"Correcto",body:r.message,type:"success"}),!0}catch(a){return i.Notify.add({icon:"/assets/img/logo.svg",title:"Error",body:a.message,type:"danger"}),!1}}),m(u,"status",async({id:t,status:a})=>{try{const{status:r,result:c}=await i.Fetch("/api/statuses/status",{method:"PATCH",body:JSON.stringify({id:t,status:a})});if(!r)throw new Error((c==null?void 0:c.message)??"Ocurrio un error inesperado");return i.Notify.add({icon:"/assets/img/logo.svg",title:"Correcto",body:c.message,type:"success"}),!0}catch(r){return i.Notify.add({icon:"/assets/img/logo.svg",title:"Error",body:r.message,type:"danger"}),!1}}),m(u,"delete",async t=>{try{const{status:a,result:r}=await i.Fetch(`/api/statuses/${t}`,{method:"DELETE"});if(!a)throw new Error((r==null?void 0:r.message)??"Ocurrio un error inesperado");return i.Notify.add({icon:"/assets/img/logo.svg",title:"Correcto",body:r.message,type:"success"}),!0}catch(a){return i.Notify.add({icon:"/assets/img/logo.svg",title:"Error",body:a.message,type:"danger"}),!1}});const A=()=>{const n=d.useRef(),t=d.useRef(),a=d.useRef(),r=d.useRef(),c=d.useRef(),[E,f]=d.useState(!1),g=e=>{e!=null&&e.id?f(!0):f(!1),a.current.value=(e==null?void 0:e.id)||null,r.current.value=(e==null?void 0:e.name)||null,c.current.value=(e==null?void 0:e.description)||null,$(t.current).modal("show")},y=async e=>{e.preventDefault();const o={id:a.current.value||void 0,name:r.current.value,description:c.current.value};await u.save(o)&&($(n.current).dxDataGrid("instance").refresh(),$(t.current).modal("hide"))},b=async({id:e,status:o})=>{await u.status({id:e,status:o})&&$(n.current).dxDataGrid("instance").refresh()},h=async e=>{await u.delete(e)&&$(n.current).dxDataGrid("instance").refresh()};return s.createElement(s.Fragment,null,s.createElement(C,{gridRef:n,title:"Estados",rest:u,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"REFRESCAR TABLA",onClick:()=>$(n.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",hint:"NUEVO REGISTRO",onClick:()=>g()}})},columns:[{dataField:"id",caption:"ID",dataType:"number",sortOrder:"asc"},{dataField:"name",caption:"Estado de proyecto"},{dataField:"description",caption:"Descripcion",cellTemplate:(e,{value:o})=>{o?l(e,o):l(e,s.createElement("i",{className:"text-muted"},"- Sin descripcion -"))}},{dataField:"status",caption:"Estado",dataType:"boolean",cellTemplate:(e,{data:o})=>{switch(o.status){case 1:l(e,s.createElement("span",{className:"badge bg-success rounded-pill"},"Activo"));break;case 0:l(e,s.createElement("span",{className:"badge bg-danger rounded-pill"},"Inactivo"));break;default:l(e,s.createElement("span",{className:"badge bg-dark rounded-pill"},"Eliminado"));break}}},{caption:"Acciones",cellTemplate:(e,{data:o})=>{e.attr("style","display: flex; gap: 4px; overflow: unset"),l(e,s.createElement(p,{className:"btn btn-xs btn-soft-primary",title:"Editar",onClick:()=>g(o)},s.createElement("i",{className:"fa fa-pen"}))),l(e,s.createElement(p,{className:"btn btn-xs btn-light",title:o.status===null?"Restaurar":"Cambiar estado",onClick:()=>b(o)},o.status===1?s.createElement("i",{className:"fa fa-toggle-on text-success"}):o.status===0?s.createElement("i",{className:"fa fa-toggle-off text-danger"}):s.createElement("i",{className:"fas fa-trash-restore"}))),l(e,s.createElement(p,{className:"btn btn-xs btn-soft-danger",title:"Eliminar",onClick:()=>h(o.id)},s.createElement("i",{className:"fa fa-trash-alt"})))},allowFiltering:!1,allowExporting:!1}]}),s.createElement(F,{modalRef:t,title:E?"Editar estado de proyecto":"Agregar estado de proyecto",onSubmit:y,size:"sm"},s.createElement("div",{className:"row"},s.createElement("input",{ref:a,type:"hidden"}),s.createElement(S,{eRef:r,label:"Estado de proyecto",col:"col-12",required:!0}),s.createElement(O,{eRef:c,label:"Descripcion",col:"col-12"}))))};v((n,t)=>{x(n).render(s.createElement(T,{session:t.session,title:"Estados"},s.createElement(A,{...t})))});
