var w=Object.defineProperty;var F=(n,s,a)=>s in n?w(n,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[s]=a;var f=(n,s,a)=>(F(n,typeof s!="symbol"?s+"":s,a),a);import{m as l,r as i,R as t,C,c as x}from"./CreateReactScript-DBaueM34.js";import{T,R as u,a as g,M as S,I as p}from"./InputFormGroup-DNB22k_n.js";import{A as O}from"./Adminto-CZDetwSn.js";import{T as A}from"./TextareaFormGroup-DOW6YXZI.js";class d{}f(d,"paginate",async s=>{const{result:a}=await l.Fetch("/api/clients/paginate",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)});return a}),f(d,"save",async s=>{try{const{status:a,result:r}=await l.Fetch("/api/clients",{method:"POST",body:JSON.stringify(s)});if(!a)throw new Error((r==null?void 0:r.message)||"Ocurrio un error inesperado");return l.Notify.add({icon:"/assets/img/logo.svg",title:"Correcto",body:r.message,type:"success"}),!0}catch(a){return l.Notify.add({icon:"/assets/img/logo.svg",title:"Error",body:a.message,type:"danger"}),!1}}),f(d,"status",async({id:s,status:a})=>{try{const{status:r,result:o}=await l.Fetch("/api/clients/status",{method:"PATCH",body:JSON.stringify({id:s,status:a})});if(!r)throw new Error((o==null?void 0:o.message)??"Ocurrio un error inesperado");return l.Notify.add({icon:"/assets/img/logo.svg",title:"Correcto",body:o.message,type:"success"}),!0}catch(r){return l.Notify.add({icon:"/assets/img/logo.svg",title:"Error",body:r.message,type:"danger"}),!1}}),f(d,"delete",async s=>{try{const{status:a,result:r}=await l.Fetch(`/api/clients/${s}`,{method:"DELETE"});if(!a)throw new Error((r==null?void 0:r.message)??"Ocurrio un error inesperado");return l.Notify.add({icon:"/assets/img/logo.svg",title:"Correcto",body:r.message,type:"success"}),!0}catch(a){return l.Notify.add({icon:"/assets/img/logo.svg",title:"Error",body:a.message,type:"danger"}),!1}});const k=({col:n,label:s,eRef:a,required:r=!1,children:o,dropdownParent:m})=>(a||(a=i.useRef()),console.log(m),i.useEffect(()=>{$(a.current).select2({dropdownParent:m})},[m]),t.createElement("div",{className:`form-group ${n} mb-2`},t.createElement("label",{htmlFor:""},s," ",r&&t.createElement("b",{className:"text-danger"},"*")),t.createElement("select",{ref:a,required:r,className:"form-control",style:{width:"100%"}},o))),D=()=>{const n=i.useRef(),s=i.useRef(),a=i.useRef(),r=i.useRef(),o=i.useRef(),m=i.useRef(),[b,E]=i.useState(!1),y=e=>{e!=null&&e.id?E(!0):E(!1),a.current.value=(e==null?void 0:e.id)||null,o.current.value=(e==null?void 0:e.name)||null,m.current.value=(e==null?void 0:e.description)||null,$(s.current).modal("show")},h=async e=>{e.preventDefault();const c={id:a.current.value||void 0,name:o.current.value,description:m.current.value};await d.save(c)&&($(n.current).dxDataGrid("instance").refresh(),$(s.current).modal("hide"))},N=async({id:e,status:c})=>{await d.status({id:e,status:c})&&$(n.current).dxDataGrid("instance").refresh()},v=async e=>{await d.delete(e)&&$(n.current).dxDataGrid("instance").refresh()};return t.createElement(t.Fragment,null,t.createElement(T,{gridRef:n,title:"Proyectos",rest:d,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"REFRESCAR TABLA",onClick:()=>$(n.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",hint:"NUEVO REGISTRO",onClick:()=>y()}})},columns:[{dataField:"id",caption:"ID",dataType:"number",sortOrder:"asc"},{dataField:"client.name",caption:"Cliente"},{dataField:"name",caption:"Proyecto"},{dataField:"description",caption:"Descripcion"},{dataField:"status",caption:"Estado",dataType:"boolean",cellTemplate:(e,{data:c})=>{switch(c.status){case 1:u(e,t.createElement("span",{className:"badge bg-success rounded-pill"},"Activo"));break;case 0:u(e,t.createElement("span",{className:"badge bg-danger rounded-pill"},"Inactivo"));break;default:u(e,t.createElement("span",{className:"badge bg-dark rounded-pill"},"Eliminado"));break}}},{caption:"Acciones",cellTemplate:(e,{data:c})=>{e.attr("style","display: flex; gap: 4px; overflow: unset"),u(e,t.createElement(g,{className:"btn btn-xs btn-soft-primary",title:"Editar",onClick:()=>y(c)},t.createElement("i",{className:"fa fa-pen"}))),u(e,t.createElement(g,{className:"btn btn-xs btn-light",title:c.status===null?"Restaurar":"Cambiar estado",onClick:()=>N(c)},c.status===1?t.createElement("i",{className:"fa fa-toggle-on text-success"}):c.status===0?t.createElement("i",{className:"fa fa-toggle-off text-danger"}):t.createElement("i",{className:"fas fa-trash-restore"}))),u(e,t.createElement(g,{className:"btn btn-xs btn-soft-danger",title:"Eliminar",onClick:()=>v(c.id)},t.createElement("i",{className:"fa fa-trash-alt"})))},allowFiltering:!1,allowExporting:!1}]}),t.createElement(S,{modalRef:s,title:b?"Editar cliente":"Agregar cliente",onSubmit:h},t.createElement("div",{className:"row",id:"client-crud-container"},t.createElement("input",{ref:a,type:"hidden"}),t.createElement(k,{eRef:r,label:"Cliente",col:"col-md-5",dropdownParent:"#client-crud-container",required:!0},t.createElement("option",{value:"Hola"},"Hola")),t.createElement(p,{eRef:o,label:"Proyecto",col:"col-md-7",required:!0}),t.createElement(A,{eRef:m,label:"Descripcion",col:"col-12"}),t.createElement(p,{label:"Fecha firma",col:"col-md-4",type:"date"}),t.createElement(p,{label:"Fecha inicio",col:"col-md-4",type:"date"}),t.createElement(p,{label:"Fecha fin",col:"col-md-4",type:"date"}))))};C((n,s)=>{x(n).render(t.createElement(O,{session:s.session,title:"Proyectos"},t.createElement(D,{...s})))});
