var P=Object.defineProperty;var I=(i,e,t)=>e in i?P(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var d=(i,e,t)=>(I(i,typeof e!="symbol"?e+"":e,t),t);import{m as a,C as q,c as x,R as s,r as c}from"./CreateReactScript-CMiyu2aM.js";import{A as _}from"./Adminto-C54wh4PN.js";import{T as B,M as D,I as m}from"./InputFormGroup-DDan9T05.js";import{T as G}from"./TextareaFormGroup-CkLVDc6p.js";import{S,a as F}from"./SetSelectValue-CLjGB2wR.js";import{m as T}from"./index-fuv_BECS.js";class l{}d(l,"paginate",async e=>{const{result:t}=await a.Fetch("/api/landings/paginate",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)});return t}),d(l,"save",async e=>{try{const{status:t,result:o}=await a.Fetch("/api/landings",{method:"POST",body:JSON.stringify(e)});if(!t)throw new Error((o==null?void 0:o.message)||"Ocurrio un error inesperado");return a.Notify.add({icon:"/assets/img/logo.svg",title:"Correcto",body:o.message,type:"success"}),!0}catch(t){return a.Notify.add({icon:"/assets/img/logo.svg",title:"Error",body:t.message,type:"danger"}),!1}}),d(l,"status",async({id:e,status:t})=>{try{const{status:o,result:n}=await a.Fetch("/api/landings/status",{method:"PATCH",body:JSON.stringify({id:e,status:t})});if(!o)throw new Error((n==null?void 0:n.message)??"Ocurrio un error inesperado");return a.Notify.add({icon:"/assets/img/logo.svg",title:"Correcto",body:n.message,type:"success"}),!0}catch(o){return a.Notify.add({icon:"/assets/img/logo.svg",title:"Error",body:o.message,type:"danger"}),!1}}),d(l,"projectStatus",async(e,t)=>{try{const{status:o,result:n}=await a.Fetch("/api/landings/project-status",{method:"PATCH",body:JSON.stringify({project:e,status:t})});if(!o)throw new Error((n==null?void 0:n.message)??"Ocurrio un error inesperado");return a.Notify.add({icon:"/assets/img/logo.svg",title:"Correcto",body:n.message,type:"success"}),!0}catch(o){return a.Notify.add({icon:"/assets/img/logo.svg",title:"Error",body:o.message,type:"danger"}),!1}}),d(l,"delete",async e=>{try{const{status:t,result:o}=await a.Fetch(`/api/landings/${e}`,{method:"DELETE"});if(!t)throw new Error((o==null?void 0:o.message)??"Ocurrio un error inesperado");return a.Notify.add({icon:"/assets/img/logo.svg",title:"Correcto",body:o.message,type:"success"}),!0}catch(t){return a.Notify.add({icon:"/assets/img/logo.svg",title:"Error",body:t.message,type:"danger"}),!1}});T.locale("es");const j=({statuses:i})=>{const e=c.useRef(),t=c.useRef(),o=c.useRef(),n=c.useRef(),f=c.useRef(),p=c.useRef(),g=c.useRef(),y=c.useRef(),h=c.useRef(),R=c.useRef(),E=c.useRef(),[C,A]=c.useState(!1),N=r=>{var u,v,b,w;A(!1),o.current.value=null,F(n.current,(u=r==null?void 0:r.client)==null?void 0:u.id,(v=r==null?void 0:r.client)==null?void 0:v.name),F(f.current,(b=r==null?void 0:r.type)==null?void 0:b.id,(w=r==null?void 0:r.type)==null?void 0:w.name),p.current.value=null,g.current.value=null,y.current.value=r==null?void 0:r.cost,h.current.value=null,R.current.value=null,E.current.value=null,$(t.current).modal("show")},O=async r=>{r.preventDefault();const u={id:o.current.value||void 0,client_id:n.current.value,type_id:f.current.value,name:p.current.value,description:g.current.value,cost:y.current.value??void 0,sign_at:h.current.value??void 0,starts_at:R.current.value,ends_at:E.current.value};await l.save(u)&&($(e.current).dxDataGrid("instance").refresh(),$(t.current).modal("hide"))};return s.createElement(s.Fragment,null,s.createElement(B,{gridRef:e,title:"Landings",rest:l,toolBar:r=>{r.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"REFRESCAR TABLA",onClick:()=>$(e.current).dxDataGrid("instance").refresh()}}),r.unshift({widget:"dxButton",location:"after",options:{icon:"plus",hint:"NUEVO REGISTRO",onClick:()=>N()}})},columns:[{dataField:"id",caption:"ID",dataType:"number",sortOrder:"asc"},{dataField:"nombre",caption:"Cliente"},{dataField:"email",caption:"Correo"},{dataField:"telefono",caption:"Telefono"},{dataField:"created_at",caption:"Fecha creacion",dataType:"datetime",cellTemplate:(r,{data:u})=>{r.text(T(u.created_at).format("LL"))}}]}),s.createElement(D,{modalRef:t,title:C?"Editar proyecto":"Agregar proyecto",onSubmit:O},s.createElement("div",{className:"row",id:"client-crud-container"},s.createElement("input",{ref:o,type:"hidden"}),s.createElement(S,{eRef:n,label:"Cliente",col:"col-12",dropdownParent:"#client-crud-container",searchAPI:"/api/clients/paginate",searchBy:"name",required:!0}),s.createElement(S,{eRef:f,label:"Tipo del proyecto",col:"col-md-4",dropdownParent:"#client-crud-container",searchAPI:"/api/types/paginate",searchBy:"name",required:!0}),s.createElement(m,{eRef:p,label:"Nombre del proyecto",col:"col-md-8",required:!0}),s.createElement(G,{eRef:g,label:"Descripcion del proyecto",col:"col-12"}),s.createElement(m,{eRef:y,label:"Costo",col:"col-md-6",type:"number",required:!0}),s.createElement(m,{eRef:h,label:"Fecha firma",col:"col-md-6",type:"date"}),s.createElement(m,{eRef:R,label:"Fecha inicio",col:"col-md-6",type:"date",required:!0}),s.createElement(m,{eRef:E,label:"Fecha fin",col:"col-md-6",type:"date",required:!0}))))};q((i,e)=>{x(i).render(s.createElement(_,{session:e.session,title:"Landings"},s.createElement(j,{...e})))});
