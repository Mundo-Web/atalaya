var C=Object.defineProperty;var x=(r,a,s)=>a in r?C(r,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[a]=s;var u=(r,a,s)=>(x(r,typeof a!="symbol"?a+"":a,s),s);import{m as l,R as t,C as F,c as T,r as i}from"./CreateReactScript-Cp5m6EeI.js";import{A as S}from"./Adminto-CfeDA4hC.js";import{T as O,R as m,a as g,M as A,I as E}from"./InputFormGroup-SAPjoTs1.js";class d{}u(d,"paginate",async a=>{const{result:s}=await l.Fetch("/api/clients/paginate",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)});return s}),u(d,"save",async a=>{try{const{status:s,result:n}=await l.Fetch("/api/clients",{method:"POST",body:JSON.stringify(a)});if(!s)throw new Error((n==null?void 0:n.message)||"Ocurrio un error inesperado");return l.Notify.add({icon:"/assets/img/logo.svg",title:"Correcto",body:n.message,type:"success"}),!0}catch(s){return l.Notify.add({icon:"/assets/img/logo.svg",title:"Error",body:s.message,type:"danger"}),!1}}),u(d,"status",async({id:a,status:s})=>{try{const{status:n,result:o}=await l.Fetch("/api/clients/status",{method:"PATCH",body:JSON.stringify({id:a,status:s})});if(!n)throw new Error((o==null?void 0:o.message)??"Ocurrio un error inesperado");return l.Notify.add({icon:"/assets/img/logo.svg",title:"Correcto",body:o.message,type:"success"}),!0}catch(n){return l.Notify.add({icon:"/assets/img/logo.svg",title:"Error",body:n.message,type:"danger"}),!1}}),u(d,"delete",async a=>{try{const{status:s,result:n}=await l.Fetch(`/api/clients/${a}`,{method:"DELETE"});if(!s)throw new Error((n==null?void 0:n.message)??"Ocurrio un error inesperado");return l.Notify.add({icon:"/assets/img/logo.svg",title:"Correcto",body:n.message,type:"success"}),!0}catch(s){return l.Notify.add({icon:"/assets/img/logo.svg",title:"Error",body:s.message,type:"danger"}),!1}});const k=({col:r,label:a,eRef:s,placeholder:n,required:o=!1})=>t.createElement("div",{className:`form-group ${r} mb-2`},t.createElement("label",{htmlFor:""},a," ",o&&t.createElement("b",{className:"text-danger"},"*")),t.createElement("textarea",{ref:s,className:"form-control",placeholder:n,required:o})),D=()=>{const r=i.useRef(),a=i.useRef(),s=i.useRef(),n=i.useRef(),o=i.useRef(),f=i.useRef(),p=i.useRef(),[h,y]=i.useState(!1),b=e=>{e!=null&&e.id?y(!0):y(!1),s.current.value=(e==null?void 0:e.id)||null,n.current.value=(e==null?void 0:e.ruc)||null,o.current.value=(e==null?void 0:e.name)||null,f.current.value=(e==null?void 0:e.description)||null,p.current.value=(e==null?void 0:e.contact)||null,$(a.current).modal("show")},R=async e=>{e.preventDefault();const c={id:s.current.value||void 0,ruc:n.current.value,name:o.current.value,description:f.current.value,contact:p.current.value};await d.save(c)&&($(r.current).dxDataGrid("instance").refresh(),$(a.current).modal("hide"))},v=async({id:e,status:c})=>{await d.status({id:e,status:c})&&$(r.current).dxDataGrid("instance").refresh()},N=async e=>{await d.delete(e)&&$(r.current).dxDataGrid("instance").refresh()};return t.createElement(t.Fragment,null,t.createElement(O,{gridRef:r,title:"Clientes",rest:d,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"REFRESCAR TABLA",onClick:()=>$(r.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",hint:"NUEVO REGISTRO",onClick:()=>b()}})},columns:[{dataField:"id",caption:"ID",dataType:"number",sortOrder:"asc"},{dataField:"name",caption:"Razon social"},{dataField:"description",caption:"Descripcion"},{dataField:"contact",caption:"Contacto"},{dataField:"status",caption:"Estado",dataType:"boolean",cellTemplate:(e,{data:c})=>{switch(c.status){case 1:m(e,t.createElement("span",{className:"badge bg-success rounded-pill"},"Activo"));break;case 0:m(e,t.createElement("span",{className:"badge bg-danger rounded-pill"},"Inactivo"));break;default:m(e,t.createElement("span",{className:"badge bg-dark rounded-pill"},"Eliminado"));break}}},{caption:"Acciones",cellTemplate:(e,{data:c})=>{e.attr("style","display: flex; gap: 4px; overflow: unset"),m(e,t.createElement(g,{className:"btn btn-xs btn-soft-primary",title:"Editar",onClick:()=>b(c)},t.createElement("i",{className:"fa fa-pen"}))),m(e,t.createElement(g,{className:"btn btn-xs btn-light",title:c.status===null?"Restaurar":"Cambiar estado",onClick:()=>v(c)},c.status===1?t.createElement("i",{className:"fa fa-toggle-on text-success"}):c.status===0?t.createElement("i",{className:"fa fa-toggle-off text-danger"}):t.createElement("i",{className:"fas fa-trash-restore"}))),m(e,t.createElement(g,{className:"btn btn-xs btn-soft-danger",title:"Eliminar",onClick:()=>N(c.id)},t.createElement("i",{className:"fa fa-trash-alt"})))},allowFiltering:!1,allowExporting:!1}]}),t.createElement(A,{modalRef:a,title:h?"Editar cliente":"Agregar cliente",onSubmit:R,size:"sm"},t.createElement("div",{className:"row"},t.createElement("input",{ref:s,type:"hidden"}),t.createElement(E,{eRef:n,label:"RUC",col:"col-12",required:!0}),t.createElement(E,{eRef:o,label:"Razon social",col:"col-12",required:!0}),t.createElement(k,{eRef:f,label:"Descripcion",col:"col-12"}),t.createElement(E,{eRef:p,label:"Celular de contacto",col:"col-12"}))))};F((r,a)=>{T(r).render(t.createElement(S,{session:a.session,title:"Clientes"},t.createElement(D,{...a})))});
