import{C as S,c as D,R as e,r as l}from"./CreateReactScript-BPb0oCFQ.js";import{T as k,R,M as w,I as c,a as _}from"./InputFormGroup-XH26D6wy.js";import{C as b}from"./ClientsRest-CQBrEZvl.js";import{A}from"./Adminto-DvH23jnX.js";import{T as M}from"./TextareaFormGroup-Da32IrqJ.js";import{m as g}from"./index-BuvcFxz3.js";import{D as G,a as I}from"./DropdownItem-LigLjXz2.js";g.locale("es");const B=({statuses:i})=>{const r=l.useRef(),h=l.useRef(),o=l.useRef(),m=l.useRef(),u=l.useRef(),d=l.useRef(),f=l.useRef(),p=l.useRef(),E=l.useRef(),[x,C]=l.useState(!1),[a,T]=l.useState({}),y=t=>{C(!1),m.current.value="",u.current.value="",d.current.value="",f.current.value="",p.current.value="",E.current.value="",$(o.current).modal("show")},F=async t=>{t.preventDefault();const n={contact_name:m.current.value,contact_email:u.current.value,contact_phone:d.current.value,name:f.current.value,web_url:p.current.value,message:E.current.value,client_width:window.screen.width,client_height:window.screen.height,client_system:navigator.platform??"Linux"};await b.save(n)&&($(r.current).dxDataGrid("instance").refresh(),$(o.current).modal("hide"))},L=t=>{T(t),$(h.current).modal("show")},v=async(t,n)=>{await b.clientStatus(t,n)&&$(r.current).dxDataGrid("instance").refresh()};return e.createElement(e.Fragment,null,e.createElement(k,{gridRef:r,title:"Leads",rest:b,toolBar:t=>{t.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"REFRESCAR TABLA",onClick:()=>$(r.current).dxDataGrid("instance").refresh()}}),t.unshift({widget:"dxButton",location:"after",options:{icon:"plus",hint:"NUEVO REGISTRO",onClick:()=>y()}})},filterValue:["client_status.id","<>",12],columns:[{dataField:"contact_name",caption:"Cliente"},{dataField:"contact_email",caption:"Correo"},{dataField:"contact_phone",caption:"Telefono"},{dataField:"client_status.id",caption:"ID estado cliente",visible:!1},{dataField:"client_status.name",caption:"Estado del cliente",dataType:"string",cellTemplate:(t,{data:n})=>{t.attr("style","display: flex; gap: 4px; overflow: unset"),R(t,e.createElement(G,{className:"btn btn-xs btn-white rounded-pill",title:n.client_status.name,tippy:"Actualizar estado"},i.map(({id:s,name:N})=>e.createElement(I,{key:s,onClick:()=>v(n.id,s)},N))))}},{dataField:"created_at",caption:"Fecha creacion",dataType:"datetime",cellTemplate:(t,{data:n})=>{t.text(g(n.created_at).format("LL"))},sortOrder:"desc"},{caption:"Acciones",cellTemplate:(t,{data:n})=>{t.attr("style","display: flex; gap: 4px; overflow: unset"),R(t,e.createElement(_,{className:"btn btn-xs btn-soft-success",title:"Convertir en cliente",onClick:()=>v(n.id,12)},e.createElement("i",{className:"fa fa-user-plus"}))),R(t,e.createElement(_,{className:"btn btn-xs btn-soft-primary",title:"Ver lead",onClick:()=>L(n)},e.createElement("i",{className:"fa fa-comment"})))},allowFiltering:!1,allowExporting:!1}]}),e.createElement(w,{modalRef:h,title:`Lead de ${a==null?void 0:a.contact_name}`,onSubmit:t=>{t.preventDefault(),$(o.current).modal("hide")}},e.createElement("div",null,e.createElement("p",null,e.createElement("b",null,"Telefono"),": ",a==null?void 0:a.contact_phone),e.createElement("p",{className:"my-2"},e.createElement("b",null,"Correo"),": ",a==null?void 0:a.contact_email),e.createElement("b",null,"Mensaje"),":",e.createElement("p",{className:"mb-0"},a==null?void 0:a.message))),e.createElement(w,{modalRef:o,title:x?"Editar lead":"Nuevo lead",btnSubmitText:"Guardar",onSubmit:F},e.createElement("div",{className:"row mb-0"},e.createElement(c,{eRef:m,label:"Nombre completo",required:!0}),e.createElement(c,{eRef:u,label:"Correo electronico",col:"col-md-6",required:!0}),e.createElement(c,{eRef:d,label:"Telefono",col:"col-md-6",required:!0}),e.createElement(c,{eRef:f,label:"Empresa / Marca",col:"col-md-6"}),e.createElement(c,{eRef:p,label:"Link de WEB",col:"col-md-6"}),e.createElement(M,{eRef:E,label:"Mensaje",placeholder:"Ingresa tu mensaje",rows:4,required:!0}))))};S((i,r)=>{D(i).render(e.createElement(A,{...r,title:"Leads"},e.createElement(B,{...r})))});
